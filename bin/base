#!/usr/bin/env bash
# vim: autoindent tabstop=4 shiftwidth=4 expandtab softtabstop=4 filetype=bash
# -*- mode: sh; indent-tabs-mode: nil; sh-basic-offset: 4 -*-

container_common_opts="\
    -t --rm\
    --mount=type=bind,source=/var/lib/containers,destination=/var/lib/containers\
    --mount=type=bind,source=/root,destination=/root\
    --mount=type=bind,source=/home,destination=/home\
    --mount=type=bind,source=/var/opt/crucible,destination=/var/opt/crucible\
    --mount=type=bind,source=/var/run/crucible,destination=/var/run/crucible\
    --mount=type=bind,source=${CRUCIBLE_HOME},destination=${CRUCIBLE_HOME}\
    --privileged --ipc=host --pid=host --net=host --cap-add=all --env-host\
    --security-opt label=disable\
    --workdir=`/bin/pwd`\
    $CRUCIBLE_CONTAINER_IMAGE"
container_run_opts="-i --name crucible-run"
container_redis_opts="-d --name crucible-redis --mount=type=bind,source=$CRUCIBLE_HOME/config/redis.conf,destination=/etc/redis.conf"
container_run_cmd="podman run $container_run_opts $container_common_opts"
container_redis_cmd="podman run $container_redis_opts $container_common_opts"
datetime=`date +%Y-%m-%d_%H:%M:%S`
base_run_dir="/var/run/crucible/$benchmark-$datetime"
